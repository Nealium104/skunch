---
import Layout from "../layouts/Layout.astro";
import "@fontsource-variable/pixelify-sans"

const fetchData = async () => {
  try {
    console.log(process.env.BASE_URL)
    const response = await fetch(`${process.env.BASE_URL}/contentful-fetch`);
    const data = await response.json();
    return data;
  } catch (error) {
    console.error('Error fetching data:', error);
    return [];
  }
};

const contentfulData = await fetchData();
---
<Layout>
    <div class="font-pixels">
        <body class="">
          <h1 class="font-pixels text-4xl font-bold">This is the skunchbucket</h1>
          <div class="flex flex-col gap-8">
          {contentfulData.map(item => (
            <article class="border-2 border-red w-1/2 p-4 gap-8">
                <h2 class="text-3xl">{item.fields.venue}</h2>
                <p>{item.fields.date}</p>
                <div class="flex gap-4">
                    {item.fields.images && item.fields.images.map(image => (
                        <div class="w-1/3 flex">
                            <img 
                                key={image.sys.id}
                                src={`https:${image.fields.file.url}`}
                                alt={image.fields.title}
                            />
                            </div>
                    ))}
                    </div>
            </article>
        ))}
          </div>
            
        </body>
    </div>
</Layout>