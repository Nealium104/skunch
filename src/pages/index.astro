---
import Layout from '../layouts/Layout.astro'
import tourData from '../data/TourData.ts'
import Concert from '../components/Concert.astro';
import { Image } from 'astro:assets';
import Icon from 'astro-icon';
import left from '../../public/images/leftPhoto.jpg'
import right from '../../public/images/rightPhoto.png'

const fetchData = async () => {
  try {
      const response = await fetch(`${process.env.BASE_URL}/contentful-fetch?content_type=gigDate`);
       const data = await response.json();
      return data;
  } catch (error) {
    console.error('Error fetching data:', error);
    return [];
  }
};

const contentfulData = await fetchData();
console.log(contentfulData)
---
<Layout>
	<div class="grid grid-cols-1 md:grid-cols-3">
		<Image class="h-full object-cover left-photo" src={left} alt="Skunch band photo"/>
		<div class="flex flex-col items-center w-full">
			<iframe class="w-full" height="400" src="https://www.youtube.com/embed/F88BniHLUiE?si=UMqIKVgYRL6vPa1w" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
			<div class="flex flex-col items-center w-full gap-8 p-4 border-8 border-red">
				<h2 class="text-3xl font-gloria font-extrabold">Tour Dates</h2 >
				<div class="w-full md:w-3/4 grid grid-cols-3 gap-4">
					<div class="text-left font-bold">Venue</div>
					<div class="text-left font-bold">Date</div>
					<div class="text-left font-bold">Note</div>
					{contentfulData.map((concert, index) => (
						<Concert
							index={index}
							venue={concert.fields.venue}
							notes={concert.fields.notes}
							url={concert.fields.url}
							date={concert.fields.date}
						/>
				))}
				</div>
			</div>
			<iframe class="bg-[#282828] py-10 border-8 border-white" src="https://open.spotify.com/embed/track/0s8wlLadanezwfSW5s4MgU?utm_source=generator&theme=0" width="100%" height="352" frameborder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
			<div class="flex flex-col w-full items-center gap-4 pb-4 border-red border-8">
				<h3 class="text-3xl">Socials</h3>
				<ul class="flex gap-8">
					<li class="text-black transition hover:text-red hover:scale-110 duration-110 hover:-translate-y-2">
						<a href="https://www.instagram.com/we.are.skunch">
							<Icon class="w-8" pack="ion" name="logo-instagram" />
						</a>
					</li>
					<li class="text-black transition hover:text-red hover:scale-110 duration-110 hover:-translate-y-2">
						<a href="https://www.tiktok.com/@skunchtheband">
							<Icon class="w-8" pack="ion" name="logo-tiktok" />
						</a>
					</li>
					<li class="text-black transition hover:text-red hover:scale-110 duration-110 hover:-translate-y-2">
						<a href="https://open.spotify.com/artist/0b7coTkjBNgqqqRQzwXjmF?si=ucVaUj-8T1y1wwiO0c6d8w&dl_branch=1">
							<Icon class="w-8" pack="ion" name="musical-notes" />
						</a>
					</li>
					<li class="text-black transition hover:text-red hover:scale-110 duration-110 hover:-translate-y-2">
						<a href="https://www.youtube.com/channel/UCOfe_3FwpjCVWYoslc_cdGA">
							<Icon class="w-8" pack="ion" name="logo-youtube" />
						</a>
					</li>
				</ul>
			</div>
		</div>
		<Image class="h-full object-cover right-photo" src={right} alt="Skunch band on an edge" />
	</div>
</Layout>
<style>
	@keyframes slideLeft {
		from {
			transform: translateX(50%);
			opacity: 0;
		}
		to {
			transform: translateX(0);
			opacity: 1;
		}
	}
	
	@keyframes slideRight {
		from {
			transform: translateX(-50%);
			opacity: 0;
		}
		to {
			transform: translateX(0);
			opacity: 1;
		}
	}
	
	.right-photo {
		animation: slideLeft 1s ease-in-out forwards;
	}
	
	.left-photo {
		animation: slideRight 1s ease-in-out forwards;
	}
</style>